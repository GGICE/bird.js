!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(1),u=r(s),c=function(){function t(e){o(this,t),this.wrap=document.querySelector(e.el),this.wrap.innerHTML=e.template,this.customEventHost=document.createElement("div"),this.randers()}return l(t,[{key:"component",value:function(t,e){var n=function(t){function n(){return o(this,n),i(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return a(n,t),l(n,[{key:"getOptions",value:function(){return e}}]),n}(u.default);document.registerElement(t,n)}},{key:"setTemplate",value:function(t){this.wrap.innerHTML=t}},{key:"randers",value:function(){}},{key:"on",value:function(t,e){var n=this.customEventHost;n.addEventListener(t,function(t){t.preventDefault(),t.stopPropagation(),e(t.detail)})}},{key:"trigger",value:function(t,e){var n=(this.customEventList,this.customEventHost),r=new CustomEvent(t,{detail:e});n.dispatchEvent(r)}}]),t}();e.default=c},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(2),u=r(s),c=n(3),f=r(c),h=function(t){function e(){return i(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))}return o(e,t),l(e,[{key:"createdCallback",value:function(){this._init()}},{key:"attachedCallback",value:function(){var t=this.attached;t&&t.apply(this)}},{key:"detachedCallback",value:function(){var t=this.removed;t&&t.apply(this)}},{key:"attributeChangedCallback",value:function(t,e,n){var r=this.attributeChanged;r&&r.apply(this,t,e,n),null===e&&this.initData&&JSON.stringify(this.initData[t])===n||this._reRender(t)}},{key:"_init",value:function(){var t=this.getOptions(),e=t.template,n=t.data,r=t.created,i=t.styles,a=t.rendered;this._initShadowEL(),e?this.template=e:this.template=null,n?(this.data=n,this.initData=Object.assign({},n)):this.data=null,this._applyAttrToData(),this._styles=i,this._rendered=a,this._btp=new u.default,this._bindAttr(),this._render(),r&&r.apply(this)}},{key:"_parse",value:function(){return this._btp._parse(this)}},{key:"_initShadowEL",value:function(){this._tempShadow=document.createElement("div").createShadowRoot(),this._shadow=this.createShadowRoot()}},{key:"_applyAttrToData",value:function(){var t=this.getAttribute("b-model");this.data=Object.assign({},this.data,JSON.parse(t||"{}"))}},{key:"_applyDataToAttr",value:function(t){for(var e in t)this.setAttribute(e,JSON.stringify(t[e]))}},{key:"_bindAttr",value:function(){var t=this.data;this._applyDataToAttr(t)}},{key:"setData",value:function(t){this.data=Object.assign(this.data,t),this._applyDataToAttr(t)}},{key:"_render",value:function(){this._shadow.innerHTML=this._parse(),this._bindEvents(),this._rendered&&this._rendered()}},{key:"_reRender",value:function(){this._tempShadow.innerHTML=this._parse(),this._diffAsyn(this._tempShadow,this._shadow),this._rendered&&this._rendered()}},{key:"_diff",value:function(t,e){if(t.innerHTML===e.innerHTML)return f.default.log("diff Same!");var n,r=this._getEls(e.childNodes),i=this._getEls(t.childNodes),a=r.length,o=i.length,l=Math.min(o,a);if(o>a)for(n=a;n<o;n++)f.default.log("Add",n,i[n]),e.appendChild(i[n]);if(o<a)for(n=a;n>o;n--)f.default.log("Remove lastChild",r[n-1]),e.removeChild(r[n-1]);for(n=0;n<l;n++)f.default.log("Change",n,r[n].outerHTML,i[n].outerHTML),i[n].outerHTML!==r[n].outerHTML&&(i[n].tagName===r[n].tagName?this._getEls(i[n].childNodes).length>0?this._diffAsyn(i[n],r[n]):(f.default.log("Change",n,r[n].outerHTML,i[n].outerHTML),e.replaceChild(i[n],r[n])):(f.default.log("Change Replace",n,r[n].outerHTML,i[n].outerHTML),e.replaceChild(i[n],r[n])))}},{key:"_diffAsyn",value:function(t,e){var n=this;return new Promise(function(r){n._diff(t,e),r()})}},{key:"_getEls",value:function(t){return[].filter.call(t,function(t){return 1===t.nodeType})}},{key:"_bindEvents",value:function(){var t=this._shadow;this._buildChildEvents(t)}},{key:"_buildChildEvents",value:function(t){var e=this;[].forEach.call(t.childNodes,function(t){t.attributes&&t.attributes.length>0&&[].forEach.call(t.attributes,function(n){var r,i,a=n.value.match(/function\[(\w+)\]/);a&&a[1]&&(i=e.data[a[1]],r=n.name.replace("on-","").toLowerCase(),i&&t.addEventListener(r,i.bind(e)))}),e._buildChildEvents(t)})}}]),e}(HTMLElement);e.default=h},function(module,exports){"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),Btp=function(){function Btp(){_classCallCheck(this,Btp)}return _createClass(Btp,[{key:"_parse",value:function _parse(options){var template=options.template,data=options.data,_styles=options._styles,html=template.replace(/\r|\f|\n/g,"").replace(/( )+/g," ");html=this._parseMap(html),html=this._parseEvent(html),html=this._parseNormal(html),html=html.replace(/b-@@##/g,"${"),html="`"+html+"`";try{html=eval(html)}catch(t){window.console.warn(t)}return _styles&&(html="<style>"+_styles+"</style>"+html),html}},{key:"_parseMap",value:function(t){return t.replace(/\w*.map.*\)/g,function(t){return t=t.replace(/{/g,"b-@@##"),t=t.replace(/"/g,"`"),t+'.join("")'})}},{key:"_parseEvent",value:function(t){return t.replace(/on-\w*={\w*}/g,function(t){return" "+t.replace(/{(\w*)}/,function(t,e){return"function["+e+"]"})})}},{key:"_parseNormal",value:function(t){return t.replace(/{/g,"${data.")}}]),Btp}();exports.default=Btp},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=window,r=n.console;e.default={isDo:function(){return window.DEBUG},log:function(){this.isDo()&&r.log(arguments)},warn:function(){this.isDo()&&r.warn(arguments)},error:function(){this.isDo()&&r.error(arguments)}}}])});